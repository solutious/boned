<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Boned::APIBase [boned 0.3.0.]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Boned::APIBase
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/boned/api/base_rb.html">lib/boned/api/base.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Sinatra::Base</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000023">assert_exists</a></li>
              <li><a href="#M000022">assert_params</a></li>
              <li><a href="#M000019">assert_secret</a></li>
              <li><a href="#M000025">assert_sha1</a></li>
              <li><a href="#M000026">assert_sha256</a></li>
              <li><a href="#M000018">assert_token</a></li>
              <li><a href="#M000024">assert_true</a></li>
              <li><a href="#M000010">body_content</a></li>
              <li><a href="#M000004">carefully</a></li>
              <li><a href="#M000021">check_signature</a></li>
              <li><a href="#M000020">check_token</a></li>
              <li><a href="#M000015">current_host</a></li>
              <li><a href="#M000013">current_uri_path</a></li>
              <li><a href="#M000006">error_message</a></li>
              <li><a href="#M000005">generic_error</a></li>
              <li><a href="#M000027">is_sha1?</a></li>
              <li><a href="#M000028">is_sha256?</a></li>
              <li><a href="#M000017">local?</a></li>
              <li><a href="#M000014">request_method</a></li>
              <li><a href="#M000009">request_secret</a></li>
              <li><a href="#M000008">request_signature</a></li>
              <li><a href="#M000007">request_token</a></li>
              <li><a href="#M000012">root_path</a></li>
              <li><a href="#M000016">secure?</a></li>
              <li><a href="#M000011">uri</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000023'>
                <a name='M000023'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_exists</span>
                  <span class='arguments'>(val, msg)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000023-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000023-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 136</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_exists</span>(<span class="ruby-identifier">val</span>, <span class="ruby-identifier">msg</span>)&#x000A;      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error_message</span> <span class="ruby-identifier">msg</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-keyword kw">true</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000022'>
                <a name='M000022'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_params</span>
                  <span class='arguments'>(*names)</span>
                </div>
                <div class='description'>
                  <p>
                  <tt>names</tt> One or more a required parameter names (Symbol)
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000022-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000022-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 128</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_params</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">names</span>)&#x000A;      <span class="ruby-identifier">names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error_message</span>(<span class="ruby-value str">&quot;Missing param: %s&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">n</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">n</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-keyword kw">true</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000019'>
                <a name='M000019'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_secret</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000019-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000019-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 98</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_secret</span>&#x000A;      <span class="ruby-identifier">assert_exists</span> <span class="ruby-identifier">request_secret</span>, <span class="ruby-value str">&quot;No secret&quot;</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000025'>
                <a name='M000025'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_sha1</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000025-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000025-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 146</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_sha1</span>(<span class="ruby-identifier">val</span>)&#x000A;      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error_message</span>(<span class="ruby-node">&quot;#{val} is not a sha1 digest&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">is_sha1?</span>(<span class="ruby-identifier">val</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000026'>
                <a name='M000026'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_sha256</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000026-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000026-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 150</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_sha256</span>(<span class="ruby-identifier">val</span>)&#x000A;      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error_message</span>(<span class="ruby-node">&quot;#{val} is not a sha256 digest&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">is_sha256?</span>(<span class="ruby-identifier">val</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000018'>
                <a name='M000018'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_token</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000018-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000018-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 94</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_token</span>&#x000A;      <span class="ruby-identifier">assert_exists</span> <span class="ruby-identifier">request_token</span>, <span class="ruby-value str">&quot;No token&quot;</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000024'>
                <a name='M000024'>      </a>
                <div class='synopsis'>
                  <span class='name'>assert_true</span>
                  <span class='arguments'>(val, msg)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000024-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000024-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 141</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assert_true</span>(<span class="ruby-identifier">val</span>, <span class="ruby-identifier">msg</span>)&#x000A;      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error_message</span> <span class="ruby-identifier">msg</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">true</span>&#x000A;      <span class="ruby-keyword kw">true</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000010'>
                <a name='M000010'>      </a>
                <div class='synopsis'>
                  <span class='name'>body_content</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000010-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000010-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 66</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">body_content</span>&#x000A;      <span class="ruby-ivar">@body_content</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">read</span> &#x000A;      <span class="ruby-ivar">@body_content</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000004'>
                <a name='M000004'>      </a>
                <div class='synopsis'>
                  <span class='name'>carefully</span>
                  <span class='arguments'>(ret='', &amp;blk)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000004-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000004-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 31</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">carefully</span>(<span class="ruby-identifier">ret</span>=<span class="ruby-value str">''</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)&#x000A;      <span class="ruby-keyword kw">begin</span>&#x000A;        <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">blk</span>.<span class="ruby-identifier">call</span>&#x000A;      <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;        <span class="ruby-identifier">generic_error</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">class</span>, <span class="ruby-identifier">ex</span>&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-identifier">ret</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000021'>
                <a name='M000021'>      </a>
                <div class='synopsis'>
                  <span class='name'>check_signature</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000021-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000021-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 107</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_signature</span>&#x000A;      <span class="ruby-identifier">assert_exists</span> <span class="ruby-identifier">request_signature</span>, <span class="ruby-value str">&quot;No signature&quot;</span>&#x000A;      <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sigversion</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">Bone</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">SIGVERSION</span>&#x000A;        <span class="ruby-identifier">error_message</span> <span class="ruby-node">&quot;API must be version: #{Bone::API::HTTP::SIGVERSION}&quot;</span>&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-comment cmt"># We need to re-parse the query string b/c Sinatra or Rack is</span>&#x000A;      <span class="ruby-comment cmt"># including the value of the POST body as a key with no value.</span>&#x000A;      <span class="ruby-identifier">qs</span> = <span class="ruby-constant">Bone</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">parse_query</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">query_string</span>&#x000A;      <span class="ruby-identifier">qs</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value str">'sig'</span> <span class="ruby-comment cmt"># Yo dawg, I put a signature in your signature</span>&#x000A;      <span class="ruby-identifier">stamp</span>, <span class="ruby-identifier">now</span> = (<span class="ruby-identifier">qs</span>[<span class="ruby-value str">'stamp'</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span>).<span class="ruby-identifier">to_i</span>, <span class="ruby-constant">Bone</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">canonical_time</span>&#x000A;      <span class="ruby-identifier">generic_error</span> <span class="ruby-node">&quot;[sig-expired] #{stamp}&quot;</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">stamp</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">30</span>.<span class="ruby-identifier">seconds</span>&#x000A;      <span class="ruby-identifier">tobj</span> = <span class="ruby-constant">Bone</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span><span class="ruby-operator">::</span><span class="ruby-constant">Redis</span><span class="ruby-operator">::</span><span class="ruby-constant">Token</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">request_token</span>&#x000A;      <span class="ruby-identifier">secret</span> = <span class="ruby-identifier">tobj</span>.<span class="ruby-identifier">secret</span>.<span class="ruby-identifier">value</span>&#x000A;      <span class="ruby-identifier">path</span> = <span class="ruby-identifier">current_uri_path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'?'</span>).<span class="ruby-identifier">first</span>&#x000A;      <span class="ruby-identifier">sig</span> = <span class="ruby-constant">Bone</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">generate_signature</span> <span class="ruby-identifier">secret</span>, <span class="ruby-identifier">current_host</span>, <span class="ruby-identifier">request_method</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">qs</span>, <span class="ruby-identifier">body_content</span>&#x000A;      <span class="ruby-identifier">generic_error</span> <span class="ruby-node">&quot;[sig-mismatch] #{sig}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sig</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">request_signature</span>&#x000A;      <span class="ruby-constant">Bone</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">request_token</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000020'>
                <a name='M000020'>      </a>
                <div class='synopsis'>
                  <span class='name'>check_token</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000020-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000020-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 102</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_token</span>&#x000A;      <span class="ruby-identifier">generic_error</span> <span class="ruby-value str">&quot;[unknown-token]&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Bone</span>.<span class="ruby-identifier">token?</span> <span class="ruby-identifier">request_token</span>&#x000A;      <span class="ruby-keyword kw">true</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000015'>
                <a name='M000015'>      </a>
                <div class='synopsis'>
                  <span class='name'>current_host</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000015-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000015-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 83</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_host</span>&#x000A;      <span class="ruby-identifier">env</span>[<span class="ruby-value str">'HTTP_HOST'</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000013'>
                <a name='M000013'>      </a>
                <div class='synopsis'>
                  <span class='name'>current_uri_path</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000013-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000013-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 77</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_uri_path</span>&#x000A;      <span class="ruby-identifier">env</span>[<span class="ruby-value str">'REQUEST_URI'</span>]&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000006'>
                <a name='M000006'>      </a>
                <div class='synopsis'>
                  <span class='name'>error_message</span>
                  <span class='arguments'>(msg)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000006-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000006-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 49</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error_message</span> <span class="ruby-identifier">msg</span>&#x000A;      <span class="ruby-constant">Bone</span>.<span class="ruby-identifier">info</span> <span class="ruby-node">&quot;[400] #{msg}&quot;</span>&#x000A;      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error</span>(<span class="ruby-value">400</span>, <span class="ruby-identifier">msg</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000005'>
                <a name='M000005'>      </a>
                <div class='synopsis'>
                  <span class='name'>generic_error</span>
                  <span class='arguments'>(event=nil, ex=nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000005-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000005-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 40</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generic_error</span>(<span class="ruby-identifier">event</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">ex</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;      <span class="ruby-constant">Bone</span>.<span class="ruby-identifier">info</span> <span class="ruby-node">&quot;#{event} #{request_token}:#{request_signature}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">event</span>.<span class="ruby-identifier">nil?</span>&#x000A;      <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">nil?</span>&#x000A;        <span class="ruby-constant">Bone</span>.<span class="ruby-identifier">info</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">message</span>&#x000A;        <span class="ruby-constant">Bone</span>.<span class="ruby-identifier">ld</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">backtrace</span> &#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">error</span>(<span class="ruby-value">404</span>, <span class="ruby-value str">&quot;Bad bone rising&quot;</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000027'>
                <a name='M000027'>      </a>
                <div class='synopsis'>
                  <span class='name'>is_sha1?</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000027-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000027-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 154</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_sha1?</span>(<span class="ruby-identifier">val</span>)&#x000A;      <span class="ruby-identifier">val</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/\A[0-9a-f]{40}\z/</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000028'>
                <a name='M000028'>      </a>
                <div class='synopsis'>
                  <span class='name'>is_sha256?</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000028-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000028-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 157</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_sha256?</span>(<span class="ruby-identifier">val</span>)&#x000A;      <span class="ruby-identifier">val</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/\A[0-9a-f]{64}\z/</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000017'>
                <a name='M000017'>      </a>
                <div class='synopsis'>
                  <span class='name'>local?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000017-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000017-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 90</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">local?</span>&#x000A;      <span class="ruby-constant">LOCAL_HOSTS</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">env</span>[<span class="ruby-value str">'SERVER_NAME'</span>]) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">client_ipaddress</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'127.0.0.1'</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000014'>
                <a name='M000014'>      </a>
                <div class='synopsis'>
                  <span class='name'>request_method</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000014-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000014-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 80</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_method</span>&#x000A;      <span class="ruby-identifier">env</span>[<span class="ruby-value str">'REQUEST_METHOD'</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span>  <span class="ruby-comment cmt"># important to be downcase for signature check</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000009'>
                <a name='M000009'>      </a>
                <div class='synopsis'>
                  <span class='name'>request_secret</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000009-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000009-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 61</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_secret</span>&#x000A;      <span class="ruby-comment cmt"># no leading/trail whitspace end</span>&#x000A;      <span class="ruby-ivar">@request_secret</span> <span class="ruby-operator">||=</span> (<span class="ruby-identifier">body_content</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">env</span>[<span class="ruby-value str">'HTTP_X_BONE_SECRET'</span>]).<span class="ruby-identifier">strip</span> &#x000A;      <span class="ruby-ivar">@request_secret</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000008'>
                <a name='M000008'>      </a>
                <div class='synopsis'>
                  <span class='name'>request_signature</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000008-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000008-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 57</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_signature</span>&#x000A;      <span class="ruby-ivar">@request_signature</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:sig</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">env</span>[<span class="ruby-value str">'HTTP_X_BONE_SIGNATURE'</span>]&#x000A;      <span class="ruby-ivar">@request_signature</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000007'>
                <a name='M000007'>      </a>
                <div class='synopsis'>
                  <span class='name'>request_token</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000007-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000007-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 54</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_token</span>&#x000A;      <span class="ruby-identifier">env</span>[<span class="ruby-value str">'HTTP_X_BONE_TOKEN'</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:token</span>] &#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000012'>
                <a name='M000012'>      </a>
                <div class='synopsis'>
                  <span class='name'>root_path</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000012-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000012-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 74</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">root_path</span>&#x000A;      <span class="ruby-identifier">env</span>[<span class="ruby-value str">'SCRIPT_NAME'</span>]&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000016'>
                <a name='M000016'>      </a>
                <div class='synopsis'>
                  <span class='name'>secure?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000016-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000016-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 86</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">secure?</span>&#x000A;      (<span class="ruby-identifier">env</span>[<span class="ruby-value str">'HTTP_X_SCHEME'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;https&quot;</span>)  <span class="ruby-comment cmt"># X-Scheme is set by nginx</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000011'>
                <a name='M000011'>      </a>
                <div class='synopsis'>
                  <span class='name'>uri</span>
                  <span class='arguments'>(*path)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000011-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000011-source'><span class="ruby-comment cmt"># File lib/boned/api/base.rb, line 71</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">uri</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">path</span>)&#x000A;      [<span class="ruby-identifier">root_path</span>, <span class="ruby-identifier">path</span>].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'/'</span>)&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
